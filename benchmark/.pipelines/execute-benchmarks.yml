trigger: none

pool:
  vmImage: 'ubuntu-latest'

parameters:
- name: benchmarkJobType
  type: string
  values: [ dry, short, medium, long ]
  default: dry

steps:
  - task: DockerInstaller@0
    inputs:
      dockerVersion: '17.09.0-ce'
  
  - powershell: docker --version
    displayName: "Docker Information"

  - powershell: |
      ${env.JOB_TYPE}='${{ parameters.benchmarkJobType }}'
      docker-compose build
    displayName: "Docker-compose build"
  
  - powershell: |
      docker-compose up
    displayName: "Docker-compose up" 

  - task: PublishBuildArtifacts@1
    displayName: "Collect Results"
    inputs:
      PathtoPublish: '$(Build.StagingDirectory)'
      ArtifactName: 'benchmark-artifacts'
      publishLocation: 'Container'

